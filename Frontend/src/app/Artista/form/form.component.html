
<app-header [title]="'Crear Artista'" [showBackButton]="true" [backUrl]="'/artistas'" [showMenu]="false"></app-header>

<ion-content class="create-artist-page">
  <form [formGroup]="form" (ngSubmit)="onSubmit()" class="form-wrap" enctype="multipart/form-data">
    
    <!-- Mensaje de error -->
    <ion-card *ngIf="errorMessage" class="error-card">
      <ion-card-content>
        <div class="error-message">
          <ion-icon name="alert-circle-outline"></ion-icon>
          <span>{{ errorMessage }}</span>
          <ion-button fill="clear" size="small" (click)="clearError()">
            <ion-icon name="close-outline"></ion-icon>
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>

    <ion-item>
      <ion-label position="stacked">Nombre</ion-label>
      <ion-input 
        formControlName="nombre" 
        type="text" 
        placeholder="Nombre del artista"
        [class.ion-invalid]="form.get('nombre')?.invalid && form.get('nombre')?.touched"
        [class.ion-touched]="form.get('nombre')?.touched">
      </ion-input>
      <ion-note slot="error" *ngIf="form.get('nombre')?.invalid && form.get('nombre')?.touched">
        <span *ngIf="form.get('nombre')?.errors?.['required']">El nombre es obligatorio</span>
        <span *ngIf="form.get('nombre')?.errors?.['minlength']">El nombre debe tener al menos 2 caracteres</span>
      </ion-note>
    </ion-item>

    <ion-item>
      <ion-label position="stacked">Imagen (opcional)</ion-label>
      <input type="file" accept="image/*" (change)="onFileSelected($event)" />
    </ion-item>

    <div class="actions">
      <ion-button type="submit" expand="block" [disabled]="form.invalid || uploading">
        <ion-icon name="add-outline" slot="start"></ion-icon>
        {{ uploading ? 'Creando...' : 'Crear artista' }}
      </ion-button>
      <ion-button fill="clear" (click)="cancelar()" [disabled]="uploading">
        <ion-icon name="arrow-back-outline" slot="start"></ion-icon>
        Cancelar
      </ion-button>
    </div>
  </form>
</ion-content>

<app-footer></app-footer>
